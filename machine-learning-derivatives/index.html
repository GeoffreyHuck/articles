<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Derivatives are frequently used in machine learning because it allows us to efficiently train a neural network. An analogy would be finding which direction you should take to reach the highest mountain but with the restriction of only being able to see one meter away.
In this article, we will first recall the rules of derivatives and partial derivatives. Then we will feature a few derivatives of functions that are commonly used in machine learning.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_derivatives_rules">The derivatives rules</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_basics">The basics</h3>
<div class="paragraph">
<p>Let&#8217;s start by the derivatives of common functions. In the following :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="machine-learning-derivatives/stem-44bc9d542a92714cac84e01cbbb7fd61.png" alt="stem 44bc9d542a92714cac84e01cbbb7fd61" width="9" height="8"></span> is a constant</p>
</li>
<li>
<p><span class="image"><img src="machine-learning-derivatives/stem-332cc365a4987aacce0ead01b8bdcc0b.png" alt="stem 332cc365a4987aacce0ead01b8bdcc0b" width="9" height="8"></span> is the variable by which we derive the functions</p>
</li>
<li>
<p><span class="image"><img src="machine-learning-derivatives/stem-190083ef7a1625fbc75f243cffb9c96d.png" alt="stem 190083ef7a1625fbc75f243cffb9c96d" width="10" height="14"></span> and <span class="image"><img src="machine-learning-derivatives/stem-3cf4fbd05970446973fc3d9fa3fe3c41.png" alt="stem 3cf4fbd05970446973fc3d9fa3fe3c41" width="10" height="12"></span> are functions</p>
</li>
<li>
<p>Also note that <span class="image"><img src="machine-learning-derivatives/stem-86ed5d32062ae006b1478b6a7a4c11ed.png" alt="stem 86ed5d32062ae006b1478b6a7a4c11ed" width="18" height="23"></span> is equivalent to <span class="image"><img src="machine-learning-derivatives/stem-9ce3fa8c71f5905e328dcae5b1d69e2d.png" alt="stem 9ce3fa8c71f5905e328dcae5b1d69e2d" width="44" height="16"></span></p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function <span class="image"><img src="machine-learning-derivatives/stem-53ca4e53600bc1d57aac5a202821be35.png" alt="stem 53ca4e53600bc1d57aac5a202821be35" width="51" height="16"></span></th>
<th class="tableblock halign-left valign-top">Derivative <span class="image"><img src="machine-learning-derivatives/stem-c52843131962aa554b42ea1cf5228463.png" alt="stem c52843131962aa554b42ea1cf5228463" width="65" height="16"></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-44bc9d542a92714cac84e01cbbb7fd61.png" alt="stem 44bc9d542a92714cac84e01cbbb7fd61" width="9" height="8"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-29632a9bf827ce0200454dd32fc3be82.png" alt="stem 29632a9bf827ce0200454dd32fc3be82" width="9" height="12"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-332cc365a4987aacce0ead01b8bdcc0b.png" alt="stem 332cc365a4987aacce0ead01b8bdcc0b" width="9" height="8"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-034d0a6be0424bffe9a6e7ac9236c0f5.png" alt="stem 034d0a6be0424bffe9a6e7ac9236c0f5" width="7" height="10"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-ca398edcb68de0f6480f309a9c343abb.png" alt="stem ca398edcb68de0f6480f309a9c343abb" width="31" height="8"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-332cc365a4987aacce0ead01b8bdcc0b.png" alt="stem 332cc365a4987aacce0ead01b8bdcc0b" width="9" height="8"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-6177db6fc70d94fdb9dbe1907695fce6.png" alt="stem 6177db6fc70d94fdb9dbe1907695fce6" width="16" height="13"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-5a5214935f8b6ee914efeece84e7535c.png" alt="stem 5a5214935f8b6ee914efeece84e7535c" width="18" height="10"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-dd14e4011870d961fb4f5097866d9009.png" alt="stem dd14e4011870d961fb4f5097866d9009" width="23" height="17"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-e89f5edbd6936745b4e9d3bfa78589a2.png" alt="stem e89f5edbd6936745b4e9d3bfa78589a2" width="51" height="31"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-bf2d19cfaedefc56a5dcb1d682141f40.png" alt="stem bf2d19cfaedefc56a5dcb1d682141f40" width="17" height="10"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-2ed987caf0c81606b3e75e2e1d580512.png" alt="stem 2ed987caf0c81606b3e75e2e1d580512" width="59" height="13"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-b6b70db98c2a5c2031dea120886f8211.png" alt="stem b6b70db98c2a5c2031dea120886f8211" width="16" height="10"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-b6b70db98c2a5c2031dea120886f8211.png" alt="stem b6b70db98c2a5c2031dea120886f8211" width="16" height="10"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-d920fa2c5de18d8732c2f6b5074660f1.png" alt="stem d920fa2c5de18d8732c2f6b5074660f1" width="16" height="10"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-e9b25d44048fe1907f8debd2395c328b.png" alt="stem e9b25d44048fe1907f8debd2395c328b" width="64" height="16"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-9c2146e0144f51c13d756bc2ada28fcc.png" alt="stem 9c2146e0144f51c13d756bc2ada28fcc" width="35" height="16"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-f6de2147c9c203a34732c0a74515a98c.png" alt="stem f6de2147c9c203a34732c0a74515a98c" width="10" height="22"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-fb9dd87ee5c46cc6f1bac5ad989387d4.png" alt="stem fb9dd87ee5c46cc6f1bac5ad989387d4" width="44" height="16"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-0a56d64204ad3484af8f8a1039645666.png" alt="stem 0a56d64204ad3484af8f8a1039645666" width="48" height="16"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-0a56d64204ad3484af8f8a1039645666.png" alt="stem 0a56d64204ad3484af8f8a1039645666" width="48" height="16"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-7b91b54d84b201968b942bf251bf3ed1.png" alt="stem 7b91b54d84b201968b942bf251bf3ed1" width="57" height="16"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here are a few derivative rules that we will use in the following sections.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Rule</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Derivative</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplication by a constant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-344b154430f36a0be3823506255474f2.png" alt="stem 344b154430f36a0be3823506255474f2" width="33" height="14"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-8fe7f41a7053b7326c1d40111d2207c1.png" alt="stem 8fe7f41a7053b7326c1d40111d2207c1" width="46" height="14"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-837808632dbb8d599a541a06f6a0019d.png" alt="stem 837808632dbb8d599a541a06f6a0019d" width="39" height="14"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-c336dccf2af000586379d218c8afa9d3.png" alt="stem c336dccf2af000586379d218c8afa9d3" width="65" height="14"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Difference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-a69893469bcc1b610c58d0c675786aab.png" alt="stem a69893469bcc1b610c58d0c675786aab" width="39" height="14"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-47f2d66d50d370444b217489fb2c48be.png" alt="stem 47f2d66d50d370444b217489fb2c48be" width="65" height="14"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Product</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-53718b4cef55e2bedec08db1ed321df2.png" alt="stem 53718b4cef55e2bedec08db1ed321df2" width="33" height="14"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-21f8e45f8db182bcb5fb73f19d581dd7.png" alt="stem 21f8e45f8db182bcb5fb73f19d581dd7" width="112" height="14"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quotient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-716e54d671041d660590dbbd60bfbcb5.png" alt="stem 716e54d671041d660590dbbd60bfbcb5" width="56" height="26"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-e753ef44cf0632276f5eb70ba956f442.png" alt="stem e753ef44cf0632276f5eb70ba956f442" width="66" height="29"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reciprocal (from quotient)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-908ffcd977040e3e12e152e5d839a878.png" alt="stem 908ffcd977040e3e12e152e5d839a878" width="56" height="26"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="machine-learning-derivatives/stem-69af355606f1d556beca9f75ba054be4.png" alt="stem 69af355606f1d556beca9f75ba054be4" width="163" height="29"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_the_chain_rule">The chain rule</h3>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-c7fa0834410afb4993d788bd34cd364d.png" alt="$$(f \circ g)' = (f' \circ g) \cdot g'$$" width="165" height="16">
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="machine-learning-derivatives/stem-29f8035de6d3defd73810dc62e37f6b1.png" alt="stem 29f8035de6d3defd73810dc62e37f6b1" width="30" height="14"></span> means <span class="image"><img src="machine-learning-derivatives/stem-0c567fa116d65b8f55f385a26f439ee9.png" alt="stem 0c567fa116d65b8f55f385a26f439ee9" width="52" height="16"></span>. We can also rewrite it using Leibniz&#8217;s notation :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-ca128c8b1e15966577f330cf56f83496.png" alt="$$\frac{\partial f}{\partial x} = \frac{\partial f}{\partial g} \cdot \frac{\partial g}{\partial x}$$" width="104" height="39">
</div>
</div>
<div class="paragraph">
<p>Which literally says : the derivative <span class="image"><img src="machine-learning-derivatives/stem-06e7cc81ea7c4442d159c33723c273db.png" alt="stem 06e7cc81ea7c4442d159c33723c273db" width="40" height="14"></span> by <span class="image"><img src="machine-learning-derivatives/stem-332cc365a4987aacce0ead01b8bdcc0b.png" alt="stem 332cc365a4987aacce0ead01b8bdcc0b" width="9" height="8"></span> is the derivative <span class="image"><img src="machine-learning-derivatives/stem-06e7cc81ea7c4442d159c33723c273db.png" alt="stem 06e7cc81ea7c4442d159c33723c273db" width="40" height="14"></span> by (<span class="image"><img src="machine-learning-derivatives/stem-c0463eeb4772bfde779c20d52901d01b.png" alt="stem c0463eeb4772bfde779c20d52901d01b" width="16" height="4"></span>) <span class="image"><img src="machine-learning-derivatives/stem-3cf4fbd05970446973fc3d9fa3fe3c41.png" alt="stem 3cf4fbd05970446973fc3d9fa3fe3c41" width="10" height="12"></span> multiplied by the derivative <span class="image"><img src="machine-learning-derivatives/stem-ac31c2a831e69e0608b9e2cc6c98249e.png" alt="stem ac31c2a831e69e0608b9e2cc6c98249e" width="40" height="14"></span>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_partial_derivatives_and_gradient">Partial derivatives and gradient</h3>
<div class="paragraph">
<p>Let&#8217;s define a function :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-c7fe33877216520e678859dd5c053ac3.png" alt="$$f(x, y) = x^2 - 3y$$" width="129" height="18">
</div>
</div>
<div class="paragraph">
<p>How can we calculate the derivative of this function ?</p>
</div>
<div class="paragraph">
<p>When a functions takes more than one variable as an argument, we can calculate the derivative of the function with respect to each variable. When we do that, <strong>the variables are treated as constants</strong> :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-3755865a8b3bc846ccc69f5a5fa1ffa1.png" alt="$$\frac{\partial f}{\partial x} =
\frac{\partial (x^2 - 3 \cdot a)}{\partial x} =
2x - 0 =
2x$$" width="186" height="28">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-a659a4d3bf97f6c1bfd7fa8ac9766b5a.png" alt="$$\frac{\partial f}{\partial y} =
\frac{\partial (a^2 - 3 y)}{\partial x} =
0 - 3 =
-3$$" width="172" height="31">
</div>
</div>
<div class="paragraph">
<p>We define the gradient of a function as the vector of all its parial derivatives, in this case the gradient <span class="image"><img src="machine-learning-derivatives/stem-5eb3506cf8721a78598195593be1aa9b.png" alt="stem 5eb3506cf8721a78598195593be1aa9b" width="23" height="14"></span> of the function <span class="image"><img src="machine-learning-derivatives/stem-190083ef7a1625fbc75f243cffb9c96d.png" alt="stem 190083ef7a1625fbc75f243cffb9c96d" width="10" height="14"></span> is :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-a13610144b39613eee6622c60afc58dc.png" alt="$$\nabla f = (2x, -3)$$" width="112" height="16">
</div>
</div>
<div class="paragraph">
<p>More generally, for a function <span class="image"><img src="machine-learning-derivatives/stem-190083ef7a1625fbc75f243cffb9c96d.png" alt="stem 190083ef7a1625fbc75f243cffb9c96d" width="10" height="14"></span> that takes a vector <span class="image"><img src="machine-learning-derivatives/stem-8ab0c01b645797173dc3a11d3799f1cf.png" alt="stem 8ab0c01b645797173dc3a11d3799f1cf" width="105" height="16"></span> as an argument, its gradient is defined by <span class="image"><img src="machine-learning-derivatives/stem-101cd389c65596a3826ae000401b0706.png" alt="stem 101cd389c65596a3826ae000401b0706" width="156" height="27"></span>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_sigmoid">The sigmoid</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A sigmoid is a "S"-shaped curve. The one we use is called the logistic function and it is defined like this :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-3ee3daaaf9e4053defcc71a6887da2fd.png" alt="$$sigmoid(x) = f(x) = \frac{1}{1 + e^{-x}}$$" width="213" height="35">
</div>
</div>
<div class="paragraph">
<p>Here is a graph of what it looks like, along with its derivative :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/sigmoid.png" alt="sigmoid" width="640" height="480">
</div>
<div class="title">Figure 1. The sigmoid function and its derivative</div>
</div>
<div class="paragraph">
<p>Let&#8217;s compute its derivative :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-ec7b69e374b66e92517f368acedcf575.png" alt="$$f(x) = \frac{1}{1 + e^{-x}}$$" width="108" height="35">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-c934cef3de1486e0e0fc01a89472ba7b.png" alt="$$f'(x) = -\frac{1}{(1 + e^{-x})^2} \cdot \frac{\partial (1 + e^{-x})}{\partial x}$$" width="246" height="43">
</div>
</div>
<div class="paragraph">
<p>After using the reciprocal rule. Now we first calculate the right part using again the reciprocal rule :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-1bfec02222e2f93730524840dbb957d5.png" alt="$$\frac{\partial (1 + e^{-x})}{\partial x} =
\frac{\partial (\frac{1}{e^{x}})}{\partial x} =
-\frac{e^x}{(e^x)^2} =
-\frac{1}{e^x} =
-e^{-x}$$" width="260" height="38">
</div>
</div>
<div class="paragraph">
<p>So we have :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-09a2443498f64f29e391eb602b863fa1.png" alt="$$f'(x) =
-\frac{1}{(1 + e^{-x})^2} \cdot (-e^{-x}) =
\frac{1}{(1 + e^{-x})^2} \cdot e^{-x} =
\frac{1}{1 + e^{-x}} \cdot \frac{e^{-x}}{1 + e^{-x}}$$" width="383" height="32">
</div>
</div>
<div class="paragraph">
<p>Now we use a little trick on the right part, adding <span class="image"><img src="machine-learning-derivatives/stem-1c61d36375294ae2354453d4a168f832.png" alt="stem 1c61d36375294ae2354453d4a168f832" width="33" height="10"></span> on the top :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-e00754eecd772a36759ba9e0a4bd2ff5.png" alt="$$f'(x) =
\frac{1}{1 + e^{-x}} \cdot \left(\frac{1 + e^{-x} - 1}{1 + e^{-x}}\right) =
\frac{1}{1 + e^{-x}} \cdot \left(\frac{1 + e^{-x}}{1 + e^{-x}} - \frac{1}{1 + e^{-x}}\right) =
\frac{1}{1 + e^{-x}} \cdot \left(1 - \frac{1}{1 + e^{-x}}\right)$$" width="510" height="29">
</div>
</div>
<div class="paragraph">
<p>You remember that <span class="image"><img src="machine-learning-derivatives/stem-2bdf51d6b6da5953c65a2097ac846972.png" alt="stem 2bdf51d6b6da5953c65a2097ac846972" width="99" height="23"></span> ? So we can write :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-62c9a621626da91c3cb64cd88d77c79e.png" alt="$$f' = f \cdot (1 - f)$$" width="114" height="16">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-84e30cccea709c7a839dc30826ccd500.png" alt="$$\frac{\partial (sigmoid)}{\partial x} = sigmoid(x) \cdot (1 - sigmoid(x))$$" width="329" height="36">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_squared_error_function">The squared error function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The squared error function is defined by :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-28db4ec7a47310b92a9dfc568fad3124.png" alt="$$squared\_error(predicted\_output) = \frac{1}{2} \cdot (true\_output - predicted\_output)^2$$" width="603" height="35">
</div>
</div>
<div class="paragraph">
<p>We usually use this function for a batch of examples, which gives us the following formula where the variables are vectors :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-f7379a86167e12cc9a64ccf334911100.png" alt="$$squared\_error(\mathbf{predicted\_output}) = \frac{1}{2} \cdot \sum_{i=1}^{n\_examples} (\mathbf{true\_output}_{[i]} - \mathbf{predicted\_output}_{[i]})^2$$" width="745" height="48">
</div>
</div>
<div class="paragraph">
<p>And sometimes, the output of an example is itself a vector (think about an artificial neural network with multiple output units), we then have the following where the variables are matrices :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-c0235723e7059049760803046db44778.png" alt="$$squared\_error(Predicted\_output) = \frac{1}{2} \cdot \sum_{i=1}^{n\_examples} \sum_{j=1}^{n\_outputs} (True\_output_{[i][j]} - Predicted\_output_{[i][j]})^2$$" width="788" height="49">
</div>
</div>
<div class="paragraph">
<p>The square of a difference is always positive, therefore the more difference there is between the true output and the predicted output, the bigger the result. The <span class="image"><img src="machine-learning-derivatives/stem-47d54de4e337a06266c0e1d22c9b417b.png" alt="stem 47d54de4e337a06266c0e1d22c9b417b" width="9" height="22"></span> term is only used because it makes the derivative more convenient, as you we see.</p>
</div>
<div class="paragraph">
<p>Now what we want is the partial derivative with respect to :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="machine-learning-derivatives/stem-2c2451a796e3c36839574918cb21d0e3.png" alt="stem 2c2451a796e3c36839574918cb21d0e3" width="146" height="14"></span> for the first variant of the function;</p>
</li>
<li>
<p><span class="image"><img src="machine-learning-derivatives/stem-e3d1843709bd5923c1bcc17e5015f873.png" alt="stem e3d1843709bd5923c1bcc17e5015f873" width="274" height="18"></span> for the second variant;</p>
</li>
<li>
<p><span class="image"><img src="machine-learning-derivatives/stem-9417bee9bdaec7d66776da5afaeec47e.png" alt="stem 9417bee9bdaec7d66776da5afaeec47e" width="358" height="18"></span> for the third variant.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When we calculate a partial derivative, all the other variables are treated as a constant. This means that in the case of the third variant, each <span class="image"><img src="machine-learning-derivatives/stem-930e3598eb1e01e928729eff88b59d87.png" alt="stem 930e3598eb1e01e928729eff88b59d87" width="329" height="22"></span> that are not of indexes <span class="image"><img src="machine-learning-derivatives/stem-fc6e56e7c0a3df5e7a2de6d18bd53fc4.png" alt="stem fc6e56e7c0a3df5e7a2de6d18bd53fc4" width="296" height="16"></span> will have a derivative equal to <span class="image"><img src="machine-learning-derivatives/stem-29632a9bf827ce0200454dd32fc3be82.png" alt="stem 29632a9bf827ce0200454dd32fc3be82" width="9" height="12"></span>.</p>
</div>
<div class="paragraph">
<p>Therefore we can get rid of the sums for the calculations of the partial derivatives of <span class="image"><img src="machine-learning-derivatives/stem-29c65edc60b58f2ed843cdcbaaae33a8.png" alt="stem 29c65edc60b58f2ed843cdcbaaae33a8" width="122" height="14"></span>, which means we only have to consider the first variant.</p>
</div>
<div class="paragraph">
<p>We will name the specific variable we derive the function for <span class="image"><img src="machine-learning-derivatives/stem-332cc365a4987aacce0ead01b8bdcc0b.png" alt="stem 332cc365a4987aacce0ead01b8bdcc0b" width="9" height="8"></span>, and the corresponding true output <span class="image"><img src="machine-learning-derivatives/stem-44bc9d542a92714cac84e01cbbb7fd61.png" alt="stem 44bc9d542a92714cac84e01cbbb7fd61" width="9" height="8"></span>.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s start :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-308f9dfbca823a4954fcc1f541c4690f.png" alt="$$f(x) = \frac{1}{2} \cdot (a - x)^2$$" width="131" height="35">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-e0b0b210d2cdd8a779cf8fb2cd1a109c.png" alt="$$f'(x) = \frac{1}{2} \cdot 2 \cdot (a - x) \cdot (-1)$$" width="204" height="35">
</div>
</div>
<div class="paragraph">
<p>After using the chain rule. Now let&#8217;s simplify the result :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-e339917ba83ce17c55c84bfa40ff3b40.png" alt="$$f'(x) = x - a$$" width="98" height="16">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-61604870abf4a20bcc58e708f7d368b9.png" alt="$$\frac{\partial (squared\_error)}{\partial predicted\_output} = predicted\_output - true\_output$$" width="442" height="40">
</div>
</div>
<div class="paragraph">
<p>Or for the second variant :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-39ce5e419384fa9cc7f9e1a1928f1cbf.png" alt="$$\frac{\partial (squared\_error)}{\partial \mathbf{predicted\_output}_{[specific\_example]}} = \mathbf{predicted\_output}_{[specific\_example]} - \mathbf{true\_output}_{[specific\_example]}$$" width="826" height="43">
</div>
</div>
<div class="paragraph">
<p>And for the third variant :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-3ca0a21985f880558510943f81a13152.png" alt="$$\frac{\partial (squared\_error)}{\partial Predicted\_output_{[specific\_example][specific\_output]}} =$$" width="408" height="43">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="machine-learning-derivatives/stem-9b76da533feaed9d977e81d118c0b024.png" alt="$$Predicted\_output_{[specific\_example][specific\_output]} - True\_output_{[specific\_example][specific\_output]}$$" width="692" height="18">
</div>
</div>
</div>
</div>